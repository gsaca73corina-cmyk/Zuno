<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>ZUNO 3D - EXTREME EDITION by GUNAR</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            overflow: hidden;
            background: radial-gradient(circle, #0d1421, #000000);
            font-family: 'Orbitron', monospace;
            user-select: none;
        }

        #game-container {
            position: relative;
            width: 100%;
            height: 100vh;
        }

        canvas {
            position: absolute;
            top: 0;
            left: 0;
            z-index: 0;
            width: 100%;
            height: 100%;
        }

        #creator-signature {
            position: absolute;
            bottom: 15px;
            right: 20px;
            z-index: 999;
            color: #00ffea;
            font-size: 16px;
            font-weight: 700;
            text-shadow: 0 0 15px #00ffea;
            letter-spacing: 3px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        #startScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2000;
            background: rgba(13, 20, 33, 0.95);
            backdrop-filter: blur(15px);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        #gameTitle {
            font-size: 5rem;
            font-weight: 900;
            background: linear-gradient(45deg, #ff0080, #00ffea, #ff4081, #00ff80);
            background-size: 400% 400%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient 2s ease-in-out infinite;
            margin-bottom: 20px;
            letter-spacing: 5px;
        }

        @keyframes gradient {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        #subtitle {
            font-size: 1.5rem;
            color: #00ffea;
            margin-bottom: 50px;
            text-transform: uppercase;
            letter-spacing: 4px;
            text-shadow: 0 0 20px rgba(0, 255, 234, 0.5);
        }

        #startBtn {
            padding: 25px 60px;
            font-size: 1.8rem;
            font-weight: 900;
            font-family: 'Orbitron', monospace;
            cursor: pointer;
            background: linear-gradient(45deg, #ff0080, #ff4081);
            color: white;
            border: 3px solid transparent;
            border-radius: 20px;
            box-shadow: 0 0 40px rgba(255, 0, 128, 0.8);
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 4px;
            position: relative;
        }

        #startBtn:hover {
            background: linear-gradient(45deg, #ff4081, #00ffea);
            box-shadow: 0 0 60px rgba(0, 255, 234, 1);
            transform: scale(1.05);
        }

        #funnyQuote {
            position: absolute;
            top: 100px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 1500;
            color: #00ff80;
            font-size: 18px;
            font-weight: 600;
            text-align: center;
            max-width: 80%;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px 30px;
            border-radius: 25px;
            border: 2px solid #00ff80;
            box-shadow: 0 0 25px rgba(0, 255, 128, 0.5);
            backdrop-filter: blur(10px);
        }

        #hud {
            position: absolute;
            top: 25px;
            left: 25px;
            z-index: 1000;
            background: rgba(13, 20, 33, 0.9);
            backdrop-filter: blur(15px);
            border: 2px solid #00ffea;
            border-radius: 15px;
            padding: 20px;
            min-width: 250px;
            box-shadow: 0 0 30px rgba(0, 255, 234, 0.3);
        }

        .hud-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            color: white;
            font-size: 16px;
            font-weight: 700;
        }

        .hud-value {
            color: #00ffea;
            text-shadow: 0 0 10px #00ffea;
        }

        #score {
            position: absolute;
            top: 25px;
            right: 25px;
            z-index: 1000;
            background: linear-gradient(45deg, #ff0080, #ff4081);
            color: white;
            padding: 20px 30px;
            border-radius: 15px;
            font-size: 22px;
            font-weight: 900;
            box-shadow: 0 0 30px rgba(255, 0, 128, 0.6);
        }

        #musicIndicator {
            position: absolute;
            bottom: 60px;
            left: 25px;
            z-index: 1000;
            color: #00ff80;
            font-size: 14px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 15px;
            border-radius: 20px;
            border: 1px solid #00ff80;
            backdrop-filter: blur(5px);
        }

        #gameOverScreen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2500;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(20px);
            border: 3px solid #ff0080;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            box-shadow: 0 0 50px rgba(255, 0, 128, 0.6);
            min-width: 400px;
        }

        #gameOverScreen h2 {
            font-size: 3rem;
            color: #ff0080;
            margin-bottom: 20px;
            text-shadow: 0 0 20px #ff0080;
        }

        .stat-item {
            display: flex;
            justify-content: space-between;
            margin: 15px 0;
            font-size: 16px;
            color: white;
        }

        .stat-value {
            color: #00ffea;
            font-weight: bold;
        }

        #restartBtn {
            margin-top: 25px;
            padding: 15px 30px;
            font-size: 16px;
            font-weight: 700;
            font-family: 'Orbitron', monospace;
            background: linear-gradient(45deg, #00ff80, #00ffea);
            color: #000;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        #restartBtn:hover {
            background: linear-gradient(45deg, #00ffea, #00ff80);
            transform: scale(1.05);
        }

        .hidden { display: none !important; }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="startScreen">
            <h1 id="gameTitle">ZUNO 3D</h1>
            <p id="subtitle">GUNAR EDITION</p>
            <button id="startBtn">üöÄ INICIAR MISI√ìN</button>
        </div>

        <div id="creator-signature">üíé HECHO POR GUNAR üíé</div>

        <div id="funnyQuote" class="hidden"></div>

        <div id="hud" class="hidden">
            <div class="hud-item">
                <span>‚è±Ô∏è TIEMPO:</span>
                <span class="hud-value" id="hudTime">0s</span>
            </div>
            <div class="hud-item">
                <span>‚ù§Ô∏è VIDAS:</span>
                <span class="hud-value" id="hudLives">3</span>
            </div>
            <div class="hud-item">
                <span>‚ö° VELOCIDAD:</span>
                <span class="hud-value" id="hudSpeed">1.0x</span>
            </div>
            <div class="hud-item">
                <span>üí• NIVEL:</span>
                <span class="hud-value" id="hudDifficulty">NORMAL</span>
            </div>
        </div>

        <div id="score" class="hidden">
            <span>üèÜ </span><span id="scoreValue">0</span><span> PTS</span>
        </div>

        <div id="musicIndicator" class="hidden">
            <span>üéµ </span><span id="currentTrack">Track 1</span>
        </div>

        <div id="gameOverScreen" class="hidden">
            <h2>üíÄ MISI√ìN FALLIDA</h2>
            <div class="stat-item">
                <span>‚è±Ô∏è Tiempo:</span>
                <span class="stat-value" id="finalTime">0s</span>
            </div>
            <div class="stat-item">
                <span>üèÜ Puntos:</span>
                <span class="stat-value" id="finalScore">0</span>
            </div>
            <div class="stat-item">
                <span>üí• Obst√°culos:</span>
                <span class="stat-value" id="finalObstacles">0</span>
            </div>
            <div class="stat-item">
                <span>üéµ Track:</span>
                <span class="stat-value" id="finalTrack">-</span>
            </div>
            <button id="restartBtn">üîÑ NUEVA MISI√ìN</button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script>
        // ZUNO 3D EXTREME BY GUNAR
        let scene, camera, renderer, player, tunnel;
        let obstacles = [], gameRunning = false;
        let obstacleSpeed = 0.5, baseSpeed = 0.5, spawnInterval = 0, lastSpawn = 0;
        let lives = 3, startTime = 0, elapsedTime = 0, score = 0, obstaclesAvoided = 0;
        let currentTrack = 1, currentQuoteIndex = 0, difficultyLevel = 1;
        const keys = {};

// FRASES EXISTENCIALES Y GRACIOSAS
const funnyQuotes = [
    // Existenciales profundas
    "üåå GUNAR: Eres polvo de estrellas‚Ä¶ pero ni brillando te ubicas.",
    "‚è≥ GUNAR: El tiempo vuela, menos tus reflejos.",
    "üåÄ GUNAR: El universo se expande‚Ä¶ como tus excusas.",
    "üî• GUNAR: La vida es un instante‚Ä¶ y ya fallaste en este.",
    "üåô GUNAR: ¬øDe qu√© sirve so√±ar si ni despierto reaccionas?",
    "‚öñÔ∏è GUNAR: Entre el ser y no ser‚Ä¶ t√∫ elegiste buggear.",
    "üß© GUNAR: La existencia es un rompecabezas‚Ä¶ al que le faltas piezas.",
    "ü™ê GUNAR: Somos min√∫sculos en el cosmos‚Ä¶ y t√∫ a√∫n m√°s.",
    "üé≠ GUNAR: El absurdo de la vida es real‚Ä¶ igual que tu punter√≠a absurda.",
    "üîÆ GUNAR: El destino existe‚Ä¶ pero ni √©l te quiere en su plan.",

    // Graciosas con trasfondo
    "ü§ñ GUNAR: Los robots no lloran‚Ä¶ pero t√∫ me das ganas.",
    "üéØ GUNAR: Tu precisi√≥n es tan real como Santa Claus.",
    "üöÄ GUNAR: M√°s perdido que sat√©lite sin √≥rbita.",
    "üíé GUNAR: Eres √∫nico‚Ä¶ como un error 404.",
    "üéÆ GUNAR: Practica m√°s‚Ä¶ o empieza a rezar.",
    "üåü GUNAR: Brillas‚Ä¶ como foco quemado.",
    "üé™ GUNAR: Bienvenido al circo de tus decisiones.",
    "‚ö° GUNAR: Tu velocidad de reacci√≥n es patrocinada por Windows XP.",
    "üé≤ GUNAR: Jugando con el destino‚Ä¶ siempre en modo principiante.",
    "üí• GUNAR: M√°s explosivo que tus fracasos en cadena.",
    "üé≠ GUNAR: Un drama c√≥smico‚Ä¶ protagonizado por ti.",
    "üåä GUNAR: Fluyendo en la vida‚Ä¶ como bloque de piedra.",
    "üß® GUNAR: Est√°s a un error de convertirte en filosof√≠a barata.",
    "üöÄ GUNAR: Tienes m√°s lag que un cometa en c√°mara lenta.",
    "üíé GUNAR: Ni yo, siendo IA, proces√© tanta incoherencia.",
    "‚ò†Ô∏è GUNAR: Somos mortales‚Ä¶ pero t√∫ te adelantas.",
    "üåå GUNAR: La nada te queda mejor que cualquier logro.",
    "üìú GUNAR: Si la vida es un guion‚Ä¶ el tuyo es comedia absurda.",
    "‚ö∞Ô∏è GUNAR: Recuerda: al final todos mueren‚Ä¶ pero no tan r√°pido como t√∫ en el juego."
];


        // ELEMENTOS DOM
        const els = {
            startScreen: document.getElementById("startScreen"),
            startBtn: document.getElementById("startBtn"),
            hud: document.getElementById("hud"),
            hudTime: document.getElementById("hudTime"),
            hudLives: document.getElementById("hudLives"),
            hudSpeed: document.getElementById("hudSpeed"),
            hudDifficulty: document.getElementById("hudDifficulty"),
            scoreValue: document.getElementById("scoreValue"),
            scoreDiv: document.getElementById("score"),
            funnyQuote: document.getElementById("funnyQuote"),
            musicIndicator: document.getElementById("musicIndicator"),
            currentTrack: document.getElementById("currentTrack"),
            gameOverScreen: document.getElementById("gameOverScreen"),
            finalTime: document.getElementById("finalTime"),
            finalScore: document.getElementById("finalScore"),
            finalObstacles: document.getElementById("finalObstacles"),
            finalTrack: document.getElementById("finalTrack"),
            restartBtn: document.getElementById("restartBtn")
        };

        function init() {
            console.log("üöÄ Inicializando ZUNO 3D by GUNAR");
            
            scene = new THREE.Scene();
            scene.fog = new THREE.Fog(0x0d1421, 10, 100);

            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 2, 6);

            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setClearColor(0x0d1421);
            renderer.shadowMap.enabled = true;
            
            document.getElementById('game-container').insertBefore(renderer.domElement, els.startScreen);

            createScene();
            setupEvents();
            showQuote();
            animate();
        }

        function createScene() {
            // LUCES
            const mainLight = new THREE.DirectionalLight(0xffffff, 2);
            mainLight.position.set(0, 10, 10);
            mainLight.castShadow = true;
            scene.add(mainLight);

            const ambientLight = new THREE.AmbientLight(0x404040, 0.4);
            scene.add(ambientLight);

            const neon1 = new THREE.PointLight(0x00ffea, 3, 30);
            neon1.position.set(-4, 0, 0);
            scene.add(neon1);

            const neon2 = new THREE.PointLight(0xff0080, 3, 30);
            neon2.position.set(4, 0, 0);
            scene.add(neon2);

            // JUGADOR
            const playerGeo = new THREE.BoxGeometry(0.5, 0.5, 0.5);
            const playerMat = new THREE.MeshPhongMaterial({ 
                color: 0x00ffea,
                shininess: 200,
                emissive: 0x002244
            });
            
            player = new THREE.Mesh(playerGeo, playerMat);
            player.position.set(0, -1.5, 0);
            player.castShadow = true;
            player.userData = { dy: 0, onGround: true, moveSpeed: 0.15 };
            scene.add(player);

            // T√öNEL
            const tunnelGeo = new THREE.CylinderGeometry(7, 7, 300, 32, 1, true);
            const tunnelMat = new THREE.MeshPhongMaterial({
                color: 0x1a1a2e,
                side: THREE.BackSide,
                wireframe: true,
                transparent: true,
                opacity: 0.7
            });
            
            tunnel = new THREE.Mesh(tunnelGeo, tunnelMat);
            tunnel.rotation.z = Math.PI / 2;
            tunnel.position.z = -145;
            scene.add(tunnel);

            // PART√çCULAS
            const particleGeo = new THREE.BufferGeometry();
            const positions = [], colors = [];

            for (let i = 0; i < 200; i++) {
                positions.push(
                    (Math.random() - 0.5) * 100,
                    (Math.random() - 0.5) * 100,
                    (Math.random() - 0.5) * 200
                );
                
                const color = new THREE.Color();
                color.setHSL(Math.random() * 0.3 + 0.7, 0.8, 0.6);
                colors.push(color.r, color.g, color.b);
            }

            particleGeo.setAttribute('position', new THREE.Float32BufferAttribute(positions, 3));
            particleGeo.setAttribute('color', new THREE.Float32BufferAttribute(colors, 3));

            const particleMat = new THREE.PointsMaterial({
                size: 3,
                vertexColors: true,
                transparent: true,
                opacity: 0.8
            });

            const particles = new THREE.Points(particleGeo, particleMat);
            scene.add(particles);
        }

        function showQuote() {
            const quote = funnyQuotes[Math.floor(Math.random() * funnyQuotes.length)];
            els.funnyQuote.textContent = quote;
            els.funnyQuote.classList.remove('hidden');
            
            setTimeout(() => {
                if (!gameRunning) showQuote();
            }, 4000);
        }

// -----------------------------
// REPRODUCCI√ìN DE M√öSICA
// -----------------------------
let audioPlayer = new Audio(); // Objeto de audio global
audioPlayer.loop = false;       // No repetir la misma canci√≥n

// Escuchar cuando termine la canci√≥n
audioPlayer.addEventListener('ended', () => {
    playNewTrack(); // Reproduce otra canci√≥n autom√°ticamente
});

let lastTrack = 0; // Para no repetir la misma canci√≥n consecutiva

function playNewTrack() {
    // Elegir track aleatorio, diferente al anterior
    let newTrack;
    do {
        newTrack = Math.floor(Math.random() * 100) + 1; // Track aleatorio 1-100
    } while (newTrack === lastTrack);

    lastTrack = newTrack;

    const trackPath = `assets/music/track${newTrack}.mp3`; // Ajusta la carpeta si es diferente

    audioPlayer.src = trackPath;   // Asignar canci√≥n al audio
    audioPlayer.play().catch(e => console.log("üéµ Error al reproducir:", e)); // Intentar reproducir

    els.currentTrack.textContent = `Track ${newTrack}`; // Actualizar HUD
    els.finalTrack.textContent = `Track ${newTrack}`;   // Actualizar pantalla de Game Over
    console.log(`üéµ Reproduciendo: ${trackPath}`);
}



        function spawnObstacle() {
            const types = ['cube', 'spike', 'wall', 'spinner'];
            const type = types[Math.floor(Math.random() * types.length)];
            
            let geometry;
            switch(type) {
                case 'cube':
                    geometry = new THREE.BoxGeometry(1, 1, 1);
                    break;
                case 'spike':
                    geometry = new THREE.ConeGeometry(0.6, 2, 8);
                    break;
                case 'wall':
                    geometry = new THREE.BoxGeometry(6, 3, 0.5);
                    break;
                case 'spinner':
                    geometry = new THREE.OctahedronGeometry(1);
                    break;
            }
            
            const material = new THREE.MeshPhongMaterial({
                color: 0xff0055,
                shininess: 100,
                emissive: 0x220011
            });
            
            const obstacle = new THREE.Mesh(geometry, material);
            
            if (type === 'wall') {
                obstacle.position.set(0, -1.5, -50);
                // Crear agujero
                const hole = new THREE.Mesh(
                    new THREE.BoxGeometry(1.5, 1.5, 1),
                    new THREE.MeshBasicMaterial({ transparent: true, opacity: 0 })
                );
                hole.position.set(
                    (Math.random() - 0.5) * 3,
                    (Math.random() - 0.5) * 2,
                    0
                );
                obstacle.add(hole);
            } else {
                obstacle.position.set(
                    (Math.random() - 0.5) * 8,
                    -1.5 + Math.random() * 3,
                    -50
                );
            }
            
            obstacle.castShadow = true;
            obstacle.userData = { 
                rotSpeed: (Math.random() - 0.5) * 0.1,
                type: type
            };
            
            scene.add(obstacle);
            obstacles.push(obstacle);
        }

        function updateGame() {
            if (!gameRunning) return;

            elapsedTime = Math.floor((Date.now() - startTime) / 1000);
            
            // Actualizar dificultad
            difficultyLevel = Math.floor(elapsedTime / 10) + 1;
            obstacleSpeed = baseSpeed * (1 + elapsedTime * 0.03);
            spawnInterval = Math.max(200, 300 - elapsedTime * 5);
            
            // Movimiento del jugador
            const speed = player.userData.moveSpeed;
            if (keys["ArrowLeft"] || keys["a"] || keys["A"]) {
                player.position.x = Math.max(player.position.x - speed, -5);
            }
            if (keys["ArrowRight"] || keys["d"] || keys["D"]) {
                player.position.x = Math.min(player.position.x + speed, 5);
            }
            if (keys["ArrowUp"] || keys["w"] || keys["W"]) {
                player.position.z = Math.max(player.position.z - speed, -2);
            }
            if (keys["ArrowDown"] || keys["s"] || keys["S"]) {
                player.position.z = Math.min(player.position.z + speed, 2);
            }

            // F√≠sica de salto
            player.position.y += player.userData.dy;
            player.userData.dy -= 0.015;

            if (player.position.y <= -1.5) {
                player.position.y = -1.5;
                player.userData.dy = 0;
                player.userData.onGround = true;
            }

            // Generar obst√°culos
            const now = Date.now();
            if (now - lastSpawn > spawnInterval) {
                spawnObstacle();
                lastSpawn = now;
            }

            // Actualizar obst√°culos
            for (let i = obstacles.length - 1; i >= 0; i--) {
                const obs = obstacles[i];
                obs.position.z += obstacleSpeed;
                
                obs.rotation.x += obs.userData.rotSpeed;
                obs.rotation.y += obs.userData.rotSpeed * 0.7;

                // Colisi√≥n
                if (player.position.distanceTo(obs.position) < 0.8) {
                    takeDamage();
                    removeObstacle(i);
                    continue;
                }

                // Remover obst√°culos pasados
                if (obs.position.z > 10) {
                    score += 10;
                    obstaclesAvoided++;
                    removeObstacle(i);
                }
            }

            // Actualizar UI
            updateHUD();
            
            // Animaci√≥n del t√∫nel
            tunnel.rotation.x += 0.005;
            tunnel.position.z += 0.1;
            if (tunnel.position.z > 100) {
                tunnel.position.z = -145;
            }

            // Cambiar m√∫sica cada 30 segundos
            if (elapsedTime > 0 && elapsedTime % 30 === 0 && Date.now() - startTime > elapsedTime * 1000 - 100) {
                playNewTrack();
            }

            // Mostrar frases ocasionalmente
            if (elapsedTime > 0 && elapsedTime % 15 === 0 && Date.now() - startTime > elapsedTime * 1000 - 100) {
                showGameQuote();
            }
        }


function showGameQuote() {
    if (!gameRunning) return;
    const quote = funnyQuotes[Math.floor(Math.random() * funnyQuotes.length)];
    els.funnyQuote.textContent = quote;
    els.funnyQuote.classList.remove('hidden');
    setTimeout(showGameQuote, 10000);
}


        function removeObstacle(index) {
            scene.remove(obstacles[index]);
            obstacles.splice(index, 1);
        }

        function takeDamage() {
            lives--;
            player.material.color.setHex(0xff0000);
            setTimeout(() => {
                if (player.material) player.material.color.setHex(0x00ffea);
            }, 200);

            if (lives <= 0) {
                endGame();
            }
        }

        function updateHUD() {
            els.hudTime.textContent = `${elapsedTime}s`;
            els.hudLives.textContent = lives;
            els.hudSpeed.textContent = `${(obstacleSpeed / baseSpeed).toFixed(1)}x`;
            els.hudDifficulty.textContent = difficultyLevel < 1 ? 'NORMAL' : 
                                          difficultyLevel < 2 ? 'DIF√çCIL' : 
                                          difficultyLevel < 5 ? 'EXTREMO' : 'IMPOSIBLE';
            els.scoreValue.textContent = score;
        }

        function startGame() {
            console.log("üéÆ Iniciando misi√≥n");
            
            gameRunning = true;
            obstacles.forEach(o => scene.remove(o));
            obstacles = [];
            
            obstacleSpeed = baseSpeed;
            lives = 3;
            score = 0;
            obstaclesAvoided = 0;
            elapsedTime = 0;
            difficultyLevel = 1;
            startTime = Date.now();
            lastSpawn = Date.now();

            player.position.set(0, -1.5, 0);
            player.userData.dy = 0;
            player.userData.onGround = true;

            els.startScreen.classList.add('hidden');
            els.hud.classList.remove('hidden');
            els.scoreDiv.classList.remove('hidden');
            els.musicIndicator.classList.remove('hidden');
            els.funnyQuote.classList.add('hidden');

            playNewTrack();
            updateHUD();
        }

        function endGame() {
            console.log("üíÄ Misi√≥n fallida");
            
            gameRunning = false;
            
            els.finalTime.textContent = `${elapsedTime}s`;
            els.finalScore.textContent = score;
            els.finalObstacles.textContent = obstaclesAvoided;
            els.gameOverScreen.classList.remove('hidden');
        }

        function resetGame() {
            els.startScreen.classList.remove('hidden');
            els.hud.classList.add('hidden');
            els.scoreDiv.classList.add('hidden');
            els.musicIndicator.classList.add('hidden');
            els.gameOverScreen.classList.add('hidden');
            showQuote();
        }

        function jump() {
            if (player.userData.onGround) {
                player.userData.dy = 0.25;
                player.userData.onGround = false;
            }
        }

        function setupEvents() {
            // Teclado
            window.addEventListener("keydown", (e) => {
                keys[e.key] = true;
                
                if (e.code === "Space" || e.code === "Enter") {
                    e.preventDefault();
                    if (!gameRunning) {
                        startGame();
                    } else {
                        jump();
                    }
                }
                
                if (e.code === "Escape" && gameRunning) {
                    endGame();
                }
            });

            window.addEventListener("keyup", (e) => {
                keys[e.key] = false;
            });

            // Botones
            els.startBtn.addEventListener("click", startGame);
            els.restartBtn.addEventListener("click", resetGame);

            // T√°ctil
            els.startBtn.addEventListener("touchstart", (e) => {
                e.preventDefault();
                startGame();
            });

            // Redimensionar
            window.addEventListener("resize", () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        }

        function animate() {
            requestAnimationFrame(animate);
            updateGame();
            renderer.render(scene, camera);
        }

        // INICIALIZAR
        window.addEventListener('load', init);
        if (document.readyState === 'complete') init();
    </script>
</body>
</html>